{% extends 'mod_corporate/base_corporate.html' %}
{% load humanize %}

{% block title %}{{block.super}} Corporate{% endblock title %}

{% block subStyle %}{% endblock subStyle %}

{% block TopCenter %}
<h4>Organisation Structure - {{ company }}</h4>
<div>
  <div id="chart_div"></div>
</div>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {packages:["orgchart"]});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'Name');
    data.addColumn('string', 'Manager');
    data.addColumn('string', 'ToolTip');

    // For each orgchart box, provide the name, manager, and tooltip to show.
    data.addRows({{ chart|safe }});
//        [
//          [{'v':'Mike', 'f':'Mike<div style="color:red; font-style:italic">President</div>'},
//           '', 'The President'],
//          [{'v':'Jim', 'f':'Jim<div style="color:red; font-style:italic">Vice President</div>'},
//           'Mike', 'VP'],
//          ['Alice', 'Mike', ''],
//          ['Bob', 'Jim', 'Bob Sponge'],
//          ['Carol', 'Bob', '']
//        ]);

    // Create the chart.
    var chart = new google.visualization.OrgChart(document.getElementById('chart_div'));
    // Draw the chart, setting the allowHtml option to true for the tooltips.
    chart.draw(data, {'allowHtml':true});
  }
</script>

<div class="row col-12">
  {% for key in departments_link.items %}
  <div class="mr-2 mb-2">
    <a href="{% url 'Corporate:OrgDepartment' key.1.cor key.1.dept  %}?next={{ request.path|urlencode }}" class="btn btn-primary align-middle">
      {{ key.1.dept }}
    </a>
  </div>
  {% endfor %}
</div>
{% endblock TopCenter %}

{% block MidTopLeft %}
  <div class="btn-group float-right">
    <a href="{% url 'Corporate:OrgAdd' corp.corporate.slug %}?next={{ request.path|urlencode }}">
      Add
    </a>

  </div>
  <h4>Organisation Structure</h4>


{% endblock MidTopLeft %}

{% block MidTopRight %}
<div class="btn-group float-right">
  <div class="btn-group mr-2">
    <a href="{% url 'Corporate:StaffManage' corp.corporate.slug %}?next={{ request.path|urlencode }}" class="badge badge-primary">
      Potential ( {{ potential|intcomma }} )
    </a>
  </div>
  <div class="btn-group mr-2">
    <a href="{% url 'Corporate:StaffCurrent' corp.corporate.slug %}?next={{ request.path|urlencode }}" class="badge badge-primary align-middle">
      Current ( {{ current_count|intcomma }} )
    </a>
  </div>
  <div class="btn-group mr-2">
    <a href="{% url 'Corporate:StaffAdmn' corp.corporate.slug %}?next={{ request.path|urlencode }}" class="badge badge-primary align-middle">
      Manage
    </a>
  </div>
  <div class="btn-group mr-2">
    <a href="{% url 'Corporate:CorpAdmin' corp.corporate.slug %}?next={{ request.path|urlencode }}" class="badge badge-primary align-middle">
      Admin
    </a>
  </div>
  <div class="btn-group mr-2">
    <a href="{% url 'Corporate:Hidden' corp.corporate.slug %}?next={{ request.path|urlencode }}" class="badge badge-secondary align-middle">
      Hidden
    </a>
  </div>
</div>
  <h4>Staff</h4>
  <canvas id="members-chart" height="100px"></canvas>
  <script>
  var config = {
    type: 'bar',
    data: {
        labels: {{ number_age_bracket_labels|safe }},
        datasets: [{
          label: 'Number Staff by Age Bracket',
          data: {{ number_age_brackets_data|safe }},
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
          },
      }
  };

window.onload = function() {
  var ctx = document.getElementById('members-chart').getContext('2d');
  window.myPie = new Chart(ctx, config);
};
  </script>


{% endblock MidTopRight %}

{% block MidBotLeft %}
  <h4>Experience</h4>
  <p>Total Skills</p>
  <p>Total Hours</p>
  <p>skills histogram by 10 year buckets</p>
{% endblock MidBotLeft %}

{% block MidBotRight %}
<h4>Past Staff</h4>
<p>where information relating to past staff can be viewed. (when the worked here, when they left etc.)</p>
{% endblock MidBotRight %}

{% block BotCenter %}
{% endblock BotCenter %}

{% block subScript %}{% endblock subScript %}
